@page "/administration/users"
@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Identity
@using NetEvent.Shared.Dto


@attribute [Authorize(Roles = "Admin")]

<MudTabs Elevation="1" Rounded="true">
    <MudTabPanel Text="User">
        <MudDataGrid T="UserDto"
                     MultiSelection="false"
                     Items="@AllUsers"
                     Sortable="true"
                     Filterable="true"
                     ReadOnly="false"
                     EditMode="DataGridEditMode.Form"
                     EditTrigger="DataGridEditTrigger.Manual"
                     CommittedItemChanges="@CommittedUserChangesAsync"
                     QuickFilter="@_usersQuickFilter"
                     Hideable="true">
            <ToolBarContent>
                <MudText Typo="Typo.h6">Users</MudText>
                <MudSpacer />
                <MudTextField @bind-Value="_UsersSearchString" Placeholder="Search" Adornment="Adornment.Start" Immediate="true"
                              AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
            </ToolBarContent>
            <Columns>
                @*<SelectColumn T="ApplicationUser" />*@
                <Column T="UserDto" Field="UserName" Title="Username" />
                <Column T="UserDto" Field="FirstName" />
                <Column T="UserDto" Field="LastName" />
                <Column T="UserDto" Field="Email" />
                @*<Column T="User" Field="PhoneNumber" Title="Molar mass" />*@
                <Column T="UserDto" Field="EmailConfirmed">
                    <CellTemplate>
                        <MudCheckBox Checked="@context.Item.EmailConfirmed" ReadOnly="true" />
                    </CellTemplate>
                    <EditTemplate>
                        <MudCheckBox @bind-Checked="@context.Item.EmailConfirmed" Label="Email confirmed" />
                    </EditTemplate>
                </Column>
                <Column T="UserDto" CellClass="d-flex justify-end">
                    <CellTemplate>
                        <MudIconButton Size="@Size.Small" Icon="@Icons.Outlined.Edit" OnClick="@context.Actions.StartEditingItem" />
                    </CellTemplate>
                </Column>
            </Columns>
            <PagerContent>
                <MudDataGridPager T="UserDto" />
            </PagerContent>
        </MudDataGrid>
    </MudTabPanel>
        <MudTabPanel Text="Roles">
        <MudDataGrid T="IdentityRole"
                     MultiSelection="false"
                     Items="@AllRoles"
                     Sortable="true"
                     Filterable="true"
                     ReadOnly="false"
                     EditMode="DataGridEditMode.Form"
                     EditTrigger="DataGridEditTrigger.Manual"
                     CommittedItemChanges="@CommittedRoleChangesAsync"
                     QuickFilter="@_roleQuickFilter"
                     Hideable="true">
            <ToolBarContent>
                <MudText Typo="Typo.h6">Roles</MudText>
                <MudSpacer />
                <MudTextField @bind-Value="_RoleSearchString" Placeholder="Search" Adornment="Adornment.Start" Immediate="true"
                              AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
            </ToolBarContent>
            <Columns>
                <Column T="IdentityRole" Field="Id" Title="Id" />
                <Column T="IdentityRole" Field="Name" />
                <Column T="IdentityRole" CellClass="d-flex justify-end">
                    <CellTemplate>
                        <MudIconButton Size="@Size.Small" Icon="@Icons.Outlined.Edit" OnClick="@context.Actions.StartEditingItem" />
                    </CellTemplate>
                </Column>
            </Columns>
            <PagerContent>
                <MudDataGridPager T="IdentityRole" />
            </PagerContent>
        </MudDataGrid>
    </MudTabPanel>
</MudTabs>
